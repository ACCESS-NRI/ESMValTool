# ESMValTool
---
documentation:
  description: |
    analyzes relationship between landcover and albedo in CMIP models
  authors:
    - crezee_bas
    - lejeune_quentin


CMIP6_landcover: &CMIP6_landcover
  additional_datasets:
#    - {dataset: CESM2, project: CMIP6, grid: gn, exp: historical, ensemble: r1i1p1f1}
#    - {dataset: UKESM1-0-LL, project: CMIP6, grid: gn, exp: historical, ensemble: r1i1p1f2}
    - {dataset: HadGEM3-GC31-LL, project: CMIP6, grid: gn, exp: historical, ensemble: r1i1p1f3}
#    - {dataset: MPI-ESM1-2-HR, project: CMIP6, grid: gn, exp: historical, ensemble: r1i1p1f1} # Problem rsds not available over 2000-2004


CMIP5_landcover: &CMIP5_landcover
  additional_datasets:
    - {dataset: MPI-ESM-LR, project: CMIP5, ensemble: r1i1p1}

preprocessors:
  pp_cmip:
    custom_order: true
    regrid:
      target_grid: 2x2
      scheme: linear
    extract_month:
      month: 7
    climate_statistics:
      operator: mean
    mask_landsea:
      mask_out: sea
  pp_obs:
    mask_landsea:
      mask_out: sea
    extract_month:
      month: 7


diagnostics:
  albedolandcover:
    description: "Multiple linear regression between albedo and xxFrac"
    variables:
      treeFrac: &variable_settings
        preprocessor: pp_cmip
        mip: Lmon
        exp: historical
        start_year: 2000
        end_year: 2004
        fx_files: [areacella]
        <<: *CMIP6_landcover
      snc:
        <<: *variable_settings
        mip: LImon
#      alb:
#        <<: *variable_settings
#        mip: Amon
#        derive: true
#        force_derivation: false
      cropFrac:
        <<: *variable_settings
      grassFrac:
        <<: *variable_settings
      shrubFrac:
        <<: *variable_settings
      pastureFrac:
        <<: *variable_settings
      albDiffiTr13:
        preprocessor: pp_obs
        mip: Amon
        additional_datasets:
          - {dataset: Duveiller2018, project: OBS, tier: 2, version: v2018,
             start_year: 2010, end_year: 2010, frequency: mon, type: clim}
    scripts:
      albedolandcover:
        script: landcover/albedolandcover.py
        params:
          latsize_BB: 5
          lonsize_BB: 5
          threshold_sumpred: 90
          mingc: 3
          minnum_gc_bb: 15
          thres_fsnow: 0.1
          snowfree: True
          lc1_class: ['treeFrac']
          lc2_class: ['shrubFrac']
          lc3_class: ['grassFrac', 'cropFrac']
